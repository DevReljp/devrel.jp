---
layout: post
title:  オンラインイベントに使えるチェックインシステムの紹介
date:   2020-03-03 12:00:00
catch: 
categories:
- コミュニティ
author: moongift
---

昨今のコロナウィルスの影響により、オンラインイベントが盛んに行われています。そんな中、受付システムがうまく提供できないのが問題でした。全体的に参加率が低めになる傾向がありますし、誰が参加していて、誰が参加していないのかも分からないのは問題です。もちろんYouTube Liveのように誰でもすぐに参加できる仕組みもありますが、それでも事前に参加登録している方くらいは分かっておきたいと思うものでしょう。

ということで、オンラインイベント用のチェックインシステムを作成したので、紹介します。

## ユーザ側の仕組み

ユーザ側の仕組みは簡単です。まずイベント管理者から送られてくるURLにアクセスします。そうすると、以下のようにチェックイン用の画面が表示されます。


ここでconnpassの受付票の番号を入力します。受付票のURLは分かっているので、クリックしてログインすれば自分の受付番号が表示されます。

受付番号を入力した後、チェックインボタンを押します。正しい受付番号であれば、以下のようにモーダルが表示されます。モーダルのURLをクリックすれば、配信用URLにジャンプできます。

番号が間違っている場合はアラートが出ます。番号があっていても、connpassの参加者データが古い場合もこのエラーになってしまいます。

## 管理者側の仕組み

管理者側はGoogleスプレッドシートで操作します。メニューにconnpassが追加されているので、それを選びます。まず参加者取り込みを選びます。

この処理はconnpassにログインして、参加者一覧をCSVから取り込みます。必要な情報は下記の通りです。

- connpassのログインID
- connpassのパスワード
- イベントページのURL

connpassのログインIDとパスワードはUserProperties、イベントページのURLはDocumentPropertieに保存しています。何度もログインしてconnpassに負荷をかけるのはよくないので、ログインが成功した際には、そのセッション情報をUserPropertiesに残しています（セッション切れの場合は再度ログインを行います）。

CSVが取得できたら、participatesシートにその内容をべた貼りしています。

### 配信用のURL設定

オンラインイベントの配信用URLが決まったら、connpassメニューのオンライン配信URL設定を選びます。


そしてプロンプトでURLを設定します。

### チェックインデータについて

参加者取り込みを行うと全データが差し替えになるので、チェックインデータは attendees シートに追加されるようになっています。同時に更新した場合などは考慮されていません（上書きされるかも…）。イベントが終わった後、LOOKUP系の関数でparticipatesシートと照らし合わせればいいかと思います。

## 配布について

Googleスプレッドシートで作った場合、簡単に配布ができないのが欠点です。初期不具合があっても対応が難しくなるので、もし興味がある人がいれば <a href="mailto:atsushi@moongift.jp">atsushi@moongift.jp</a> または<a href="https://twitter.com/goofmint">@goofmint</a>までご連絡ください。シートを共有して利用してもらいつつ、デバッグに協力してもらえれば。


